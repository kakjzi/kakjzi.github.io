{"componentChunkName":"component---src-templates-post-jsx","path":"/cost2/","result":{"data":{"site":{"siteMetadata":{"title":"Shin, Jiwoo"}},"markdownRemark":{"id":"37b0c210-1408-5a2e-8ccd-d64ef6027b55","excerpt":"안녕하세요!👋🏻 지금까지 AWS의 EC2에 Attach되어 있는 IP 주소에 대해서는 과금하지 않았는데, 2024년 2월 1일부터 AWS Public IPv4 주소 사용이 시간당 0.005 USD 과금됩니다. 또한, 신규 AWS 프리티어 고객인 경우 매달 750시간의 Public IP 주소를 무료로 사용할 수 있습니다. AWS는 Public IP Insig…","html":"<p>안녕하세요!👋🏻</p>\n<p>지금까지 AWS의 EC2에 Attach되어 있는 IP 주소에 대해서는 과금하지 않았는데, <strong>2024년 2월 1일</strong>부터 AWS Public IPv4 주소 사용이 시간당 0.005 USD 과금됩니다.</p>\n<p>또한, 신규 AWS 프리티어 고객인 경우 매달 750시간의 Public IP 주소를 무료로 사용할 수 있습니다. AWS는 Public IP Insights라는 새로운 기능을 통해 고객이 자신의 Public IPv4 주소 사용 현황을 모니터링하고 최적화할 수 있도록 지원합니다. 이를 통해 불필요한 비용을 줄이고 IPv4 주소 사용을 효율적으로 관리할 수 있습니다.</p>\n<h2>실제 사례</h2>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/c5d88a7c3c4db08026bf51ad73c1ffeb/5b5fb/publicIp_cost.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 15.294117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkUlEQVR42l2OXQ6DIBCEOUlRBAUFBQXqb3r/U01X0pf68GV2MpPdZb2b4ZcVY8iQnUUtTaFRPQRpJbrCq27Bf/MTTpkePIwNYEo7xPeJhUjrhbx/kLYLIe1ozYiqMRBqgJ0iHXTkezr4Dxe65PdTTOqRPtwQ4l7wkeZ8UCFBtBYNLVFmwpyOord/cvcG6juf8QUVxlnjhRcBsAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='청구서 내역' title='' src='/static/c5d88a7c3c4db08026bf51ad73c1ffeb/ca1dc/publicIp_cost.png' srcset='/static/c5d88a7c3c4db08026bf51ad73c1ffeb/e7570/publicIp_cost.png 170w,\n/static/c5d88a7c3c4db08026bf51ad73c1ffeb/f46e7/publicIp_cost.png 340w,\n/static/c5d88a7c3c4db08026bf51ad73c1ffeb/ca1dc/publicIp_cost.png 680w,\n/static/c5d88a7c3c4db08026bf51ad73c1ffeb/02d09/publicIp_cost.png 1020w,\n/static/c5d88a7c3c4db08026bf51ad73c1ffeb/9d567/publicIp_cost.png 1360w,\n/static/c5d88a7c3c4db08026bf51ad73c1ffeb/5b5fb/publicIp_cost.png 2128w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>청구서 내역</figcaption>\n  </figure></p>\n<p>실제로 비용청구되는 것을 해석해보면,</p>\n<p>'Idle' Public IPv4 주소의 경우, 시간당 $0.005의 비용이 부과됩니다. 총 58.092시간 동안 'Idle' 상태였으므로, 이에 대한 총 비용은 USD 0.29입니다. 이는 Public IPv4 주소가 할당되었지만 실제로 데이터 전송에 사용되지 않는 시간에 대한 비용입니다.</p>\n<p>'In-use' Public IPv4 주소는 시간당 $0.005의 비용이 부과되며, 총 5.807시간 동안 사용되어 총 비용은 USD 0.03입니다. 'In-use' 상태는 주소가 실제 데이터 전송에 사용되는 시간을 의미합니다.</p>\n<p>또한, Public IPv4 주소의 과금이 시간당이 아니라 분 단위로 이루어진다는 것을 알 수 있습니다.\n이는 AWS가 Public IPv4 주소 사용에 대해 더 세밀한 과금 체계를 적용하고 있음을 의미합니다.</p>\n<h2>Public IP 에 대해 추적하고 편리하게 관리하기 위한 명령어</h2>\n<p>명령어는 아래의 목적을 차례대로 갖고 있습니다.</p>\n<ol>\n<li>VPC 내에서 사용되지 않고 있는(즉, 어떤 인스턴스에도 연결되지 않은) Elastic IP 주소를 조회</li>\n<li>네트워크 인터페이스의 정보를 조회하여 공용 IP 주소가 연결된 인터페이스를 필터링</li>\n</ol>\n<h3>window</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># VPC 내에서 사용되지 않고 있는(즉, 어떤 인스턴스에도 연결되지 않은) Elastic IP 주소를 조회</span>\naws ec2 describe-addresses <span class=\"token parameter variable\">--region</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>리전정보<span class=\"token punctuation\">]</span> <span class=\"token parameter variable\">--filters</span> <span class=\"token string\">\"Name=domain,Values=vpc\"</span> <span class=\"token operator\">|</span> ConvertFrom-Json <span class=\"token operator\">|</span> ForEach-Object <span class=\"token punctuation\">{</span> $.Addresses <span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> Where-Object <span class=\"token punctuation\">{</span> <span class=\"token variable\">$null</span> <span class=\"token parameter variable\">-eq</span> $.AssociationId <span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> Select-Object PublicIp, AllocationId, @<span class=\"token punctuation\">{</span>Name<span class=\"token operator\">=</span><span class=\"token string\">'Region'</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">Expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token variable\">$_</span>.NetworkBorderGroup<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>, @<span class=\"token punctuation\">{</span>Name<span class=\"token operator\">=</span><span class=\"token string\">'Status'</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">Expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'미사용'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>, NetworkInterfaceId\n\n<span class=\"token comment\"># 네트워크 인터페이스의 정보를 조회하여 공용 IP 주소가 연결된 인터페이스를 필터링</span>\naws ec2 describe-network-interfaces <span class=\"token parameter variable\">--region</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>리전정보<span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> ConvertFrom-Json <span class=\"token operator\">|</span> % <span class=\"token punctuation\">{</span> $.NetworkInterfaces <span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> Where-Object <span class=\"token punctuation\">{</span> $.Association <span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> Select-Object @<span class=\"token punctuation\">{</span>Name<span class=\"token operator\">=</span><span class=\"token string\">'PublicIp'</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">Expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>$.Association.PublicIp<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>, @<span class=\"token punctuation\">{</span>Name<span class=\"token operator\">=</span><span class=\"token string\">'Region'</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">Expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>$.AvailabilityZone<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>, @<span class=\"token punctuation\">{</span>Name<span class=\"token operator\">=</span><span class=\"token string\">'Status'</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">Expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>if <span class=\"token punctuation\">(</span>$.Status <span class=\"token parameter variable\">-eq</span> <span class=\"token string\">'in-use'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'사용'</span><span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'미사용'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>, @<span class=\"token punctuation\">{</span>Name<span class=\"token operator\">=</span><span class=\"token string\">'AllocationId'</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">Expression</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>$.Association.AllocationId<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>, NetworkInterfaceId</code></pre></div>\n<h3>mac</h3>\n<p>사전 준비 : <code class=\"language-text\">brew install jq</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># VPC 내에서 사용되지 않고 있는(즉, 어떤 인스턴스에도 연결되지 않은) Elastic IP 주소를 조회</span>\naws ec2 describe-addresses <span class=\"token parameter variable\">--region</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>리전정보<span class=\"token punctuation\">]</span> <span class=\"token parameter variable\">--filters</span> <span class=\"token string\">\"Name=domain,Values=vpc\"</span> <span class=\"token operator\">|</span> jq <span class=\"token string\">'.Addresses | map(select(.AssociationId == null)) | .[] | {PublicIp: .PublicIp, AllocationId: .AllocationId, Region: .NetworkBorderGroup, Status: \"미사용\", NetworkInterfaceId: .NetworkInterfaceId}'</span>\n\n\n<span class=\"token comment\"># 네트워크 인터페이스의 정보를 조회하여 공용 IP 주소가 연결된 인터페이스를 필터링</span>\naws ec2 describe-network-interfaces <span class=\"token parameter variable\">--region</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>리전정보<span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> jq <span class=\"token string\">'.NetworkInterfaces | map(select(.Association != null)) | .[] | {PublicIp: .Association.PublicIp, Region: .AvailabilityZone, Status: if .Status == \"in-use\" then \"사용\" else \"미사용\", AllocationId: .Association.AllocationId, NetworkInterfaceId: .NetworkInterfaceId}'</span></code></pre></div>\n<br/>\n<h5>참고</h5>\n<p><a href=\"https://aws.amazon.com/ko/blogs/korea/new-aws-public-ipv4-address-charge-public-ip-insights/\">Public IP</a></p>\n<p><a href=\"https://aws.amazon.com/ko/about-aws/whats-new/2024/02/aws-free-tier-750-hours-free-public-ipv4-addresses/\">Public IP 프리티어</a></p>\n<p><a href=\"https://aws.amazon.com/ko/blogs/networking-and-content-delivery/identify-and-optimize-public-ipv4-address-usage-on-aws/\">Public IP Optimizer</a></p>","frontmatter":{"title":"[AWS] Public IP 과금 소식","date":"February 13, 2024","update":"February 13, 2024","tags":["AWS","Cost"],"series":"AWS 비용"},"fields":{"slug":"/cost2/","readingTime":{"minutes":4.285}}},"seriesList":{"edges":[{"node":{"id":"5ec3aee9-22d9-5a42-a65b-3697851690c9","fields":{"slug":"/cost1/"},"frontmatter":{"title":"[AWS] 비용 비교: Lambda vs. EC2"}}},{"node":{"id":"37b0c210-1408-5a2e-8ccd-d64ef6027b55","fields":{"slug":"/cost2/"},"frontmatter":{"title":"[AWS] Public IP 과금 소식"}}}]},"previous":{"fields":{"slug":"/cost1/"},"frontmatter":{"title":"[AWS] 비용 비교: Lambda vs. EC2"}},"next":null},"pageContext":{"id":"37b0c210-1408-5a2e-8ccd-d64ef6027b55","series":"AWS 비용","previousPostId":"5ec3aee9-22d9-5a42-a65b-3697851690c9","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}